var mobilePhoneIsOk=false;var userNameIsOk=false;var emailIsOk=false;var mobilePhoneByIsOk=true;var nameIsOk=false;var birthdayIsOk=false;var productionIsOk=true;var address4IsOk=false;var checkReg={emailReg:/^(([a-zA-Z0-9]+\w*((\.\w+)|(-\w+))*[\.-]?[a-zA-Z0-9]+)|([a-zA-Z0-9]))\@[a-zA-Z0-9]+((\.|-)[a-zA-Z0-9]+)*\.[a-zA-Z0-9]+$/,mobilePhoneReg:/^1[3,4,5,6,7,8,9][0-9]{9}$/,numberReg:/^[0-9]*$/,nameReg:/^(\w|[\u4E00-\u9FA5]|\s)*$/,upperCaseReg:/[A-Z]/g,userNameReg:/^(\w|[\u4E00-\u9FA5])*$/,lang_zh:{"3101":"4-20个字符，可由小写字母、中文、数字组成","3102":"用户名不能为空","3103":"该用户名已被使用，请更换其它用户名","3104":"最少4个字符，请输入您的用户名","3105":"最多只能为20个字符","3106":"用户名不能全由数字组成！","3107":"用户名不能有大写字母！","3108":"用户名只能是数字，小写字母和汉字","3110":"请填写真实姓名","3111":"请填写出生年月日","3112":"出生日期不正确，请重新输入","3132":"姓名不能为空","3141":"请选择并填写地址","3144":"地址最长只能为50个汉字（100个字符）","3151":"请输入邮箱","3153":"邮箱格式不正确，请重新输入","3154":"该邮箱已被注册，请更换其它邮箱","3193":"姓名只能为2-30个字符，不允许特殊符号","3201":"请输入手机号码","3202":"手机号不能为空","3203":"手机号格式不正确，请重新输入","3204":"此手机号已注册，请更换其它手机号","3205":"请输入推荐人的手机号码","3206":"手机号格式不正确，请重新输入","3207":"请输入已注册推荐人的手机号码","3210":"请输入主要生产类别","3211":"最长只能为50个汉字（100个字符），不允许特殊符号","3241":"注册失败，请稍后重试。"},mobilePhone:{checkMobilePhoneFocus:function(){checkReg.tool.switchInputStyle("normal","mobilePhone","tipImgMobilePhone","tipInfoMobilePhone");$("#tipInfoMobilePhone").html(checkReg.lang_zh["3201"])},checkMobilePhone:function(){checkReg.tool.switchInputStyle("normal","mobilePhone","tipImgMobilePhone","tipInfoMobilePhone");mobilePhoneIsOk=false;var a=false;var b=$.trim($("#mobilePhone").val());if(b==""){return false}if(!checkReg.mobilePhoneReg.test(b)){checkReg.tool.switchInputStyle("error","mobilePhone","tipImgMobilePhone","tipInfoMobilePhone");$("#tipInfoMobilePhone").html(checkReg.lang_zh["3203"]);return false}$.ajax({type:"POST",url:$("#contextPath").val()+"/commonapi/checkUser",dataType:"json",data:{key:b},async:false,success:function(c){if(c==false){checkReg.tool.switchInputStyle("error","mobilePhone","tipImgMobilePhone","tipInfoMobilePhone");$("#tipInfoMobilePhone").html(checkReg.lang_zh["3204"]);a=true;return false}}});if(a==true){return false}checkReg.tool.switchInputStyle("ok","mobilePhone","tipImgMobilePhone","tipInfoMobilePhone");mobilePhoneIsOk=true;return true}},userName:{checkFocus:function(){checkReg.tool.switchInputStyle("normal","userName","tipImgUserName","tipUserName");$("#tipInfoUserName").html(checkReg.lang_zh["3101"])},checkKeypress:function(){var b=$.trim($("#userName").val());if(b==""){return false}var a=checkReg.tool.VerifyCharLength(b,20);if(a&&("flag" in a)&&a.flag===false){checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName");$("#tipInfoUserName").text(checkReg.lang_zh["3105"]);$("#userName").val(b.substr(0,a.charLen));return false}else{checkReg.tool.switchInputStyle("normal","userName","tipImgUserName","tipInfoUserName")}},checkUserName:function(){userNameIsOk=false;var b=false;checkReg.tool.switchInputStyle("normal","userName","tipImgUserName","tipInfoUserName");var c=$.trim($("#userName").val());if(c==""){return false}var a=checkReg.userName.VerifyFormatUserName(c);if(a&&("flag" in a)&&a.flag===false){checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName");$("#tipInfoUserName").text(a.errorInfo);return false}$.ajax({type:"POST",url:$("#contextPath").val()+"/commonapi/checkUser",dataType:"json",data:{key:c},async:false,success:function(d){if(d==false){checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName");$("#tipInfoUserName").html(checkReg.lang_zh["3103"].replace("{#userName#}",c));b=true;return false}},error:function(){return false}});if(b==true){return false}checkReg.tool.switchInputStyle("ok","userName","tipImgUserName","tipInfoUserName");userNameIsOk=true;return true},VerifyFormatUserName:function(c){var d="";var b=false;var a={flag:b,errorInfo:""};if(c&&c!=""){if(GetCharLength(c)<4){d=checkReg.lang_zh["3104"];b=false}else{if(GetCharLength(c)>20){d=checkReg.lang_zh["3105"];b=false}else{if(checkReg.numberReg.test(c)){d=checkReg.lang_zh["3106"];b=false}else{if(checkReg.upperCaseReg.test(c)){d=checkReg.lang_zh["3107"];b=false}else{if(c.match(checkReg.userNameReg)){b=true}else{d=checkReg.lang_zh["3108"];b=false}}}}}a={flag:b,errorInfo:d}}return a}},email:{checkEmailFocus:function(){checkReg.tool.switchInputStyle("normal","email","tipImgEmail","tipInfoEmail");$("#tipInfoEmail").html(checkReg.lang_zh["3151"])},checkEmail:function(){emailIsOk=false;var b=false;checkReg.tool.switchInputStyle("normal","email","tipImgEmail","tipInfoEmail");var a=$.trim($("#email").val());if(a==""){emailIsOk=true;return true}if(a.length>40||!checkReg.emailReg.test(a)){checkReg.tool.switchInputStyle("error","email","tipImgEmail","tipInfoEmail");$("#tipInfoEmail").html(checkReg.lang_zh["3153"]);return false}if(/[ ]/.test(a)){checkReg.tool.switchInputStyle("error","email","tipImgEmail","tipInfoEmail");$("#tipInfoEmail").html(checkReg.lang_zh["3153"]);return false}$.ajax({type:"POST",url:$("#contextPath").val()+"/commonapi/checkUser",dataType:"json",data:{key:a},async:false,success:function(c){if(c==false){checkReg.tool.switchInputStyle("error","email","tipImgEmail","tipInfoEmail");$("#tipInfoEmail").html(checkReg.lang_zh["3154"]);b=true;return}}});if(b==true){return false}checkReg.tool.switchInputStyle("ok","email","tipImgEmail","tipInfoEmail");emailIsOk=true;return true}},mobilePhoneBy:{checkMobilePhoneByFocus:function(){checkReg.tool.switchInputStyle("normal","mobilePhoneBy","tipImgMobilePhoneBy","tipInfoMobilePhoneBy");$("#tipInfoMobilePhoneBy").html(checkReg.lang_zh["3205"])},checkMobilePhoneBy:function(){checkReg.tool.switchInputStyle("normal","mobilePhoneBy","tipImgMobilePhoneBy","tipInfoMobilePhoneBy");mobilePhoneByIsOk=false;var a=true;var b=$.trim($("#mobilePhoneBy").val());if(b==""){mobilePhoneByIsOk=true;return true}if(!checkReg.mobilePhoneReg.test(b)){checkReg.tool.switchInputStyle("error","mobilePhoneBy","tipImgMobilePhoneBy","tipInfoMobilePhoneBy");$("#tipInfoMobilePhoneBy").html(checkReg.lang_zh["3206"]);return false}$.ajax({type:"POST",url:$("#contextPath").val()+"/commonapi/checkUser",dataType:"json",data:{key:b},async:false,success:function(c){if(c==true){checkReg.tool.switchInputStyle("error","mobilePhoneBy","tipImgMobilePhoneBy","tipInfoMobilePhoneBy");$("#tipInfoMobilePhoneBy").html(checkReg.lang_zh["3207"]);a=false;return false}}});if(a==false){return false}checkReg.tool.switchInputStyle("ok","mobilePhoneBy","tipImgMobilePhoneBy","tipInfoMobilePhoneBy");mobilePhoneByIsOk=true;return true}},name:{checkNameFocus:function(){checkReg.tool.switchInputStyle("normal","name","tipImgInfoName","tipInfoName");$("#tipInfoName").html(checkReg.lang_zh["3110"])},checkKeypress:function(){var b=$.trim($("#name").val());if(b==""){return true}var a=checkReg.tool.VerifyCharLength(b,30);if(a&&("flag" in a)&&a.flag===false){checkReg.tool.switchInputStyle("error","name","tipImgInfoName","tipInfoName");$("#tipInfoName").text(checkReg.lang_zh["3193"]);$("#name").val(b.substr(0,a.charLen));return false}else{checkReg.tool.switchInputStyle("normal","name","tipImgInfoName","tipInfoName");return true}},checkName:function(){nameIsOk=false;checkReg.tool.switchInputStyle("normal","name","tipImgInfoName","tipInfoName");var b=$.trim($("#name").val());if(b==""){return false}var a=GetCharLength(b);if(a<2||a>30){checkReg.tool.switchInputStyle("error","name","tipImgInfoName","tipInfoName");$("#tipInfoName").html(checkReg.lang_zh["3193"]);return false}if(!checkReg.nameReg.test(b)){checkReg.tool.switchInputStyle("error","name","tipImgInfoName","tipInfoName");$("#tipInfoName").html(checkReg.lang_zh["3193"]);return false}checkReg.tool.switchInputStyle("ok","name","tipImgInfoName","tipInfoName");nameIsOk=true;return true}},birthday:{checkBirthdayFocus:function(){checkReg.tool.switchInputStyle("normal","birthday","tipImgInfoBirthday","tipInfoBirthday");$("#tipInfoBirthday").html(checkReg.lang_zh["3111"]);var a=$.trim($("#birthday").val());if(a==null||a==""){$("#birthday").attr("value","1988-01-01")}},checkBirthday:function(){birthdayIsOk=false;checkReg.tool.switchInputStyle("normal","birthday","tipImgInfoBirthday","tipInfoBirthday");var c=$.trim($("#birthday").val());if(c==""){birthdayIsOk=true;return true}if(false==(new Date(c).getDate()==c.substring(c.length-2))){checkReg.tool.switchInputStyle("error","birthday","tipImgInfoBirthday","tipInfoBirthday");$("#tipInfoBirthday").html(checkReg.lang_zh["3112"]);return false}var a=new Date();var b=new Date(c);if(a.getFullYear()<=b.getFullYear()){checkReg.tool.switchInputStyle("error","birthday","tipImgInfoBirthday","tipInfoBirthday");$("#tipInfoBirthday").html(checkReg.lang_zh["3112"]);return false}checkReg.tool.switchInputStyle("ok","birthday","tipImgInfoBirthday","tipInfoBirthday");birthdayIsOk=true;return true}},production:{checkProductionFocus:function(){checkReg.tool.switchInputStyle("normal","production","tipImgInfoProduction","tipInfoProduction");$("#tipInfoProduction").html(checkReg.lang_zh["3210"])},checkKeypress:function(){var b=$.trim($("#production").val());if(b==""){return true}var a=checkReg.tool.VerifyCharLength(b,100);if(a&&("flag" in a)&&a.flag===false){checkReg.tool.switchInputStyle("error","production","tipImgInfoProduction","tipInfoProduction");$("#tipInfoProduction").text(checkReg.lang_zh["3211"]);$("#production").val(b.substr(0,a.charLen));return false}else{checkReg.tool.switchInputStyle("normal","production","tipImgInfoProduction","tipInfoProduction");return true}},checkProduction:function(){productionIsOk=false;checkReg.tool.switchInputStyle("normal","production","tipImgInfoProduction","tipInfoProduction");var b=$.trim($("#production").val());if(b==""){productionIsOk=true;return true}var a=GetCharLength(b);if(a<2||a>100){checkReg.tool.switchInputStyle("error","production","tipImgInfoProduction","tipInfoProduction");$("#tipInfoProduction").html(checkReg.lang_zh["3211"]);return false}if(!checkReg.nameReg.test(b)){checkReg.tool.switchInputStyle("error","production","tipImgInfoProduction","tipInfoProduction");$("#tipInfoProduction").html(checkReg.lang_zh["3211"]);return false}checkReg.tool.switchInputStyle("ok","production","tipImgInfoProduction","tipInfoProduction");productionIsOk=true;return true}},address:{checkAddressFocus:function(){checkReg.tool.switchInputStyle("normal","address4","tipImgAddress4","tipInfoAddress4");$("#tipInfoAddress4").html(checkReg.lang_zh["3141"])},checkKeypress:function(){var b=$.trim($("#address4").val());if(b==""){return true}var a=checkReg.tool.VerifyCharLength(b,100);if(a&&("flag" in a)&&a.flag===false){checkReg.tool.switchInputStyle("error","address4","tipImgAddress4","tipInfoAddress4");$("#tipInfoAddress4").text(checkReg.lang_zh["3144"]);$("#address4").val(b.substr(0,a.charLen));return false}else{checkReg.tool.switchInputStyle("normal","address4","tipImgAddress4","tipInfoAddress4")}},checkAddress:function(){address4IsOk=false;checkReg.tool.switchInputStyle("normal","address4","tipImgAddress4","tipInfoAddress4");var b=$("#tipInfoAddr");var c=$("#address4").val();if(c==""){address4IsOk=true;return true}var a=GetCharLength(c);if(a>100){checkReg.tool.switchInputStyle("error","address4","tipImgAddress4","tipInfoAddress4");$("#tipInfoAddress4").html(checkReg.lang_zh["3144"]);return false}if(!checkReg.nameReg.test(c)){checkReg.tool.switchInputStyle("error","address4","tipImgAddress4","tipInfoAddress4");$("#tipInfoAddress4").html(checkReg.lang_zh["3144"]);return false}address4IsOk=true;checkReg.tool.switchInputStyle("ok","address4","tipImgAddress4","tipInfoAddress4");return true}},tool:{switchInputStyle:function(d,a,c,b){if(d=="normal"){$("#"+a).removeClass("was-validated is-invalid is-valid");$("#"+b).removeClass("invalid-feedback").addClass("valid-feedback").html("").css({display:"block"})}else{if(d=="ok"){$("#"+a).addClass("was-validated is-valid").removeClass("is-invalid");$("#"+b).removeClass("invalid-feedback").addClass("valid-feedback").css({display:"block"})}else{if(d=="error"){$("#"+a).addClass("was-validated is-invalid").removeClass("is-valid");$("#"+b).addClass("invalid-feedback").addClass("valid-feedback").css({display:"block"})}}}},isFunc:function(a){return typeof a=="function"},VerifyCharLength:function(h,b){var d=b;var f=true;var c={flag:f,charLen:d};if(h&&h!=""){if(GetCharLength(h)>b){var g=h.length;f=false;var a=0;for(var e=0;e<g;e++){a+=GetCharLength(h[e]);if(a==b){d=(e+1);break}else{if(a>b){d=e;break}}}}c={flag:f,charLen:d}}return c}}};function GetCharLength(c){var b=0;for(var a=0;a<c.length;a++){if(c.charCodeAt(a)>255){b+=2}else{b+=1}}return b}function check_register(d){var a=$.trim($("#mobilePhone").val());var c=$.trim($("#userName").val());var b=$.trim($("#name").val());if(c==""||a==""||b==""){if(a==""){checkReg.tool.switchInputStyle("error","mobilePhone","tipImgMobilePhone","tipInfoMobilePhone");$("#tipInfoMobilePhone").html(checkReg.lang_zh["3202"])}if(c==""){checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName");$("#tipInfoUserName").html(checkReg.lang_zh["3102"])}if(b==""){checkReg.tool.switchInputStyle("error","name","tipImgName","tipInfoName");$("#tipInfoName").html(checkReg.lang_zh["3132"])}submitBtnAvailability("enable");d.preventDefault();return false}if(mobilePhoneIsOk&&userNameIsOk&&emailIsOk&&mobilePhoneByIsOk&&nameIsOk&&productionIsOk&&birthdayIsOk&&address4IsOk){return true}else{d.preventDefault();submitBtnAvailability("enable");return false}}function verifyRollback(){checkReg.mobilePhone.checkMobilePhone();checkReg.userName.checkUserName();checkReg.email.checkEmail();checkReg.mobilePhoneBy.checkMobilePhoneBy();checkReg.name.checkName();checkReg.birthday.checkBirthday();checkReg.production.checkProduction();checkReg.address.checkAddress()}function submitBtnAvailability(a){if(a=="disable"){$("#saveButtonUnclick").show();$("#saveButton").hide()}else{$("#saveButtonUnclick").hide();$("#saveButton").show()}}$(function(){verifyRollback();$("#mobilePhone").bind("focus",function(){checkReg.mobilePhone.checkMobilePhoneFocus()});$("#mobilePhone").blur(function(){checkReg.mobilePhone.checkMobilePhone()});$("#userName").bind("focus",function(){checkReg.userName.checkFocus()});$("#userName").on("keyup",function(){checkReg.userName.checkKeypress()});$("#userName").blur(function(){checkReg.userName.checkUserName()});$("#email").bind("focus",function(){checkReg.email.checkEmailFocus()});$("#email").blur(function(){checkReg.email.checkEmail()});$("#mobilePhoneBy").bind("focus",function(){checkReg.mobilePhoneBy.checkMobilePhoneByFocus()});$("#mobilePhoneBy").blur(function(){checkReg.mobilePhoneBy.checkMobilePhoneBy()});$("#name").bind("focus",function(){checkReg.name.checkNameFocus()});$("#name").blur(function(){checkReg.name.checkName()});$("#name").on("keyup",function(){checkReg.name.checkKeypress()});$("#birthday").on("focus",function(){checkReg.birthday.checkBirthdayFocus()});$("#birthday").on("blur",function(){checkReg.birthday.checkBirthday()});$("#production").bind("focus",function(){checkReg.production.checkProductionFocus()});$("#production").blur(function(){checkReg.production.checkProduction()});$("#production").on("keyup",function(){checkReg.production.checkKeypress()});$("#address4").on("focus",function(){checkReg.address.checkAddressFocus()});$("#address4").on("keyup",function(){checkReg.address.checkKeypress()});$("#address4").on("blur",function(){checkReg.address.checkAddress()});$("form").submit(function(a){submitBtnAvailability("disable");setTimeout(check_register(a),50)})});