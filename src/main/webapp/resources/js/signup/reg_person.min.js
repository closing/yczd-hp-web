"use strict";function GetCharLength(e){for(var t=0,a=0;a<e.length;a++)e.charCodeAt(a)>255?t+=2:t+=1;return t}function check_register(e){var t=$.trim($("#mobilePhone").val()),a=$.trim($("#userName").val()),c=$.trim($("#name").val());$.trim($("#address4").val());return""==a||""==t||""==c?(""==t&&(checkReg.tool.switchInputStyle("error","mobilePhone","tipImgMobile","tipInfoMobilePhone"),$("#tipInfoMobilePhone").html(checkReg.lang_zh[3202])),""==a&&(checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName"),$("#tipInfoUserName").html(checkReg.lang_zh[3102])),""==c&&(checkReg.tool.switchInputStyle("error","name","tipImgName","tipInfoName"),$("#tipInfoName").html(checkReg.lang_zh[3132])),submitBtnAvailability("enable"),e.preventDefault(),!1):!!(mobilePhoneIsOk&&userNameIsOk&&emailIsOk&&nameIsOk&&birthdayIsOk&&address4IsOk)||(e.preventDefault(),submitBtnAvailability("enable"),!1)}function verifyRollback(){checkReg.mobilePhone.checkMobilePhone(),checkReg.userName.checkUserName(),checkReg.email.checkEmail(),checkReg.name.checkName(),checkReg.birthday.checkBirthday(),checkReg.address.checkAddress()}function submitBtnAvailability(e){"disable"==e?($("#saveButtonUnclick").show(),$("#saveButton").hide()):($("#saveButtonUnclick").hide(),$("#saveButton").show())}var mobilePhoneIsOk=!1,userNameIsOk=!1,emailIsOk=!1,nameIsOk=!1,birthdayIsOk=!1,address4IsOk=!1,checkReg={emailReg:/^(([a-zA-Z0-9]+\w*((\.\w+)|(-\w+))*[\.-]?[a-zA-Z0-9]+)|([a-zA-Z0-9]))\@[a-zA-Z0-9]+((\.|-)[a-zA-Z0-9]+)*\.[a-zA-Z0-9]+$/,mobilePhoneReg:/^1[3,4,5,6,7,8,9][0-9]{9}$/,numberReg:/^[0-9]*$/,nameReg:/^(\w|[\u4E00-\u9FA5]|\s)*$/,upperCaseReg:/[A-Z]/g,userNameReg:/^(\w|[\u4E00-\u9FA5])*$/,lang_zh:{3101:"4-20个字符，可由小写字母、中文、数字组成",3102:"用户名不能为空",3103:"该用户名已被使用，请更换其它用户名",3104:"最少4个字符，请输入您的用户名",3105:"最多只能为20个字符",3106:"用户名不能全由数字组成！",3107:"用户名不能有大写字母！",3108:"用户名只能是数字，小写字母和汉字",3110:"请填写真实姓名",3111:"请填写出生年月日",3112:"出生日期不正确，请重新输入",3132:"姓名不能为空",3141:"请选择并填写地址",3144:"地址最长只能为50个汉字（100个字符）",3151:"请输入邮箱",3153:"邮箱格式不正确，请重新输入",3154:"该邮箱已被注册，请更换其它邮箱",3193:"姓名只能为2-30个字符，不允许特殊符号",3201:"请输入手机号码",3202:"手机号不能为空",3203:"手机号格式不正确，请重新输入",3204:"此手机号已注册，请更换其它手机号",3241:"注册失败，请稍后重试。"},mobilePhone:{checkMobilePhoneFocus:function(){checkReg.tool.switchInputStyle("normal","mobilePhone","tipImgMobilePhone","tipInfoMobilePhone"),$("#tipInfoMobilePhone").html(checkReg.lang_zh[3201])},checkMobilePhone:function(){checkReg.tool.switchInputStyle("normal","mobilePhone","tipImgMobile","tipInfoMobilePhone"),mobilePhoneIsOk=!1;var e=!1,t=$.trim($("#mobilePhone").val());return""!=t&&(checkReg.mobilePhoneReg.test(t)?($.ajax({type:"POST",url:$("#contextPath").val()+"/commonapi/checkUser",dataType:"json",data:{key:t},async:!1,success:function(t){if(0==t)return checkReg.tool.switchInputStyle("error","mobilePhone","tipImgMobile","tipInfoMobilePhone"),$("#tipInfoMobilePhone").html(checkReg.lang_zh[3204]),e=!0,!1}}),1!=e&&(checkReg.tool.switchInputStyle("ok","mobilePhone","tipImgMobile","tipInfoMobilePhone"),mobilePhoneIsOk=!0,!0)):(checkReg.tool.switchInputStyle("error","mobilePhone","tipImgMobile","tipInfoMobilePhone"),$("#tipInfoMobilePhone").html(checkReg.lang_zh[3203]),!1))}},userName:{checkFocus:function(){checkReg.tool.switchInputStyle("normal","userName","tipImgUserName","tipUserName"),$("#tipInfoUserName").html(checkReg.lang_zh[3101])},checkKeypress:function(){var e=$.trim($("#userName").val());if(""==e)return!1;var t=checkReg.tool.VerifyCharLength(e,20);if(t&&"flag"in t&&!1===t.flag)return checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName"),$("#tipInfoUserName").text(checkReg.lang_zh[3105]),$("#userName").val(e.substr(0,t.charLen)),!1;checkReg.tool.switchInputStyle("normal","userName","tipImgUserName","tipInfoUserName")},checkUserName:function(){userNameIsOk=!1;var e=!1;checkReg.tool.switchInputStyle("normal","userName","tipImgUserName","tipInfoUserName");var t=$.trim($("#userName").val());if(""==t)return!1;var a=checkReg.userName.VerifyFormatUserName(t);return a&&"flag"in a&&!1===a.flag?(checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName"),$("#tipInfoUserName").text(a.errorInfo),!1):($.ajax({type:"POST",url:$("#contextPath").val()+"/commonapi/checkUser",dataType:"json",data:{key:t},async:!1,success:function(a){if(0==a)return checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName"),$("#tipInfoUserName").html(checkReg.lang_zh[3103].replace("{#userName#}",t)),e=!0,!1},error:function(){return!1}}),1!=e&&(checkReg.tool.switchInputStyle("ok","userName","tipImgUserName","tipInfoUserName"),userNameIsOk=!0,!0))},VerifyFormatUserName:function(e){var t="",a=!1,c={flag:a,errorInfo:""};return e&&""!=e&&(GetCharLength(e)<4?(t=checkReg.lang_zh[3104],a=!1):GetCharLength(e)>20?(t=checkReg.lang_zh[3105],a=!1):checkReg.numberReg.test(e)?(t=checkReg.lang_zh[3106],a=!1):checkReg.upperCaseReg.test(e)?(t=checkReg.lang_zh[3107],a=!1):e.match(checkReg.userNameReg)?a=!0:(t=checkReg.lang_zh[3108],a=!1),c={flag:a,errorInfo:t}),c}},email:{checkEmailFocus:function(){checkReg.tool.switchInputStyle("normal","email","tipImgEmail","tipInfoEmail"),$("#tipInfoEmail").html(checkReg.lang_zh[3151])},checkEmail:function(){emailIsOk=!1;var e=!1;checkReg.tool.switchInputStyle("normal","email","tipImgEmail","tipInfoEmail");var t=$.trim($("#email").val());return""==t?(emailIsOk=!0,!0):t.length>40||!checkReg.emailReg.test(t)?(checkReg.tool.switchInputStyle("error","email","tipImgEmail","tipInfoEmail"),$("#tipInfoEmail").html(checkReg.lang_zh[3153]),!1):/[ ]/.test(t)?(checkReg.tool.switchInputStyle("error","email","tipImgEmail","tipInfoEmail"),$("#tipInfoEmail").html(checkReg.lang_zh[3153]),!1):($.ajax({type:"POST",url:$("#contextPath").val()+"/commonapi/checkUser",dataType:"json",data:{key:t},async:!1,success:function(t){if(0==t)return checkReg.tool.switchInputStyle("error","email","tipImgEmail","tipInfoEmail"),$("#tipInfoEmail").html(checkReg.lang_zh[3154]),void(e=!0)}}),1!=e&&(checkReg.tool.switchInputStyle("ok","email","tipImgEmail","tipInfoEmail"),emailIsOk=!0,!0))}},name:{checkNameFocus:function(){checkReg.tool.switchInputStyle("normal","name","tipImgInfoName","tipInfoName"),$("#tipInfoName").html(checkReg.lang_zh[3110])},checkKeypress:function(){var e=$.trim($("#name").val());if(""==e)return!0;var t=checkReg.tool.VerifyCharLength(e,30);return t&&"flag"in t&&!1===t.flag?(checkReg.tool.switchInputStyle("error","name","tipImgInfoName","tipInfoName"),$("#tipInfoName").text(checkReg.lang_zh[3193]),$("#name").val(e.substr(0,t.charLen)),!1):(checkReg.tool.switchInputStyle("normal","name","tipImgInfoName","tipInfoName"),!0)},checkName:function(){nameIsOk=!1,checkReg.tool.switchInputStyle("normal","name","tipImgInfoName","tipInfoName");var e=$.trim($("#name").val());if(""==e)return!1;var t=GetCharLength(e);return t<2||t>30?(checkReg.tool.switchInputStyle("error","name","tipImgInfoName","tipInfoName"),$("#tipInfoName").html(checkReg.lang_zh[3193]),!1):checkReg.nameReg.test(e)?(checkReg.tool.switchInputStyle("ok","name","tipImgInfoName","tipInfoName"),nameIsOk=!0,!0):(checkReg.tool.switchInputStyle("error","name","tipImgInfoName","tipInfoName"),$("#tipInfoName").html(checkReg.lang_zh[3193]),!1)}},birthday:{checkBirthdayFocus:function(){checkReg.tool.switchInputStyle("normal","birthday","tipImgInfoBirthday","tipInfoBirthday"),$("#tipInfoAddr").html(checkReg.lang_zh[3111])},checkBirthday:function(){birthdayIsOk=!1,checkReg.tool.switchInputStyle("normal","birthday","tipImgInfoBirthday","tipInfoBirthday");var e=$.trim($("#birthday").val());if(""==e)return birthdayIsOk=!0,!0;if(0==(new Date(e).getDate()==e.substring(e.length-2)))return checkReg.tool.switchInputStyle("error","birthday","tipImgInfoBirthday","tipInfoBirthday"),$("#tipInfoBirthday").html(checkReg.lang_zh[3112]),!1;var t=new Date,a=new Date(e);return t.getFullYear()<=a.getFullYear()?(checkReg.tool.switchInputStyle("error","birthday","tipImgInfoBirthday","tipInfoBirthday"),$("#tipInfoBirthday").html(checkReg.lang_zh[3112]),!1):(checkReg.tool.switchInputStyle("ok","birthday","tipImgInfoBirthday","tipInfoBirthday"),birthdayIsOk=!0,!0)}},address:{checkAddressFocus:function(){checkReg.tool.switchInputStyle("normal","address4","tipImgAddress4","tipInfoAddress4"),$("#tipInfoAddress4").html(checkReg.lang_zh[3141])},checkKeypress:function(){var e=$.trim($("#address4").val());if(""==e)return!0;var t=checkReg.tool.VerifyCharLength(e,100);if(t&&"flag"in t&&!1===t.flag)return checkReg.tool.switchInputStyle("error","address4","tipImgAddress4","tipInfoAddress4"),$("#tipInfoAddress4").text(checkReg.lang_zh[3144]),$("#address4").val(e.substr(0,t.charLen)),!1;checkReg.tool.switchInputStyle("normal","address4","tipImgAddress4","tipInfoAddress4")},checkAddress:function(){address4IsOk=!1,checkReg.tool.switchInputStyle("normal","address4","tipImgAddress4","tipInfoAddress4");var e=($("#tipInfoAddr"),$("#address4").val());return""==e?(address4IsOk=!0,!0):GetCharLength(e)>100?(checkReg.tool.switchInputStyle("error","address4","tipImgAddress4","tipInfoAddress4"),$("#tipInfoAddress4").html(checkReg.lang_zh[3144]),!1):checkReg.nameReg.test(e)?(address4IsOk=!0,checkReg.tool.switchInputStyle("ok","address4","tipImgAddress4","tipInfoAddress4"),!0):(checkReg.tool.switchInputStyle("error","address4","tipImgAddress4","tipInfoAddress4"),$("#tipInfoAddress4").html(checkReg.lang_zh[3144]),!1)}},tool:{switchInputStyle:function(e,t,a,c){"normal"==e?($("#"+t).removeClass("was-validated is-invalid is-valid"),$("#"+c).removeClass("invalid-feedback").addClass("valid-feedback").html("").css({display:"block"})):"ok"==e?($("#"+t).addClass("was-validated is-valid").removeClass("is-invalid"),$("#"+c).removeClass("invalid-feedback").addClass("valid-feedback").css({display:"block"})):"error"==e&&($("#"+t).addClass("was-validated is-invalid").removeClass("is-valid"),$("#"+c).addClass("invalid-feedback").addClass("valid-feedback").css({display:"block"}))},isFunc:function(e){return"function"==typeof e},VerifyCharLength:function(e,t){var a=t,c=!0,n={flag:c,charLen:a};if(e&&""!=e){if(GetCharLength(e)>t){var i=e.length;c=!1;for(var o=0,r=0;r<i;r++){if((o+=GetCharLength(e[r]))==t){a=r+1;break}if(o>t){a=r;break}}}n={flag:c,charLen:a}}return n}}};$(function(){verifyRollback(),$("#mobilePhone").bind("focus",function(){checkReg.mobilePhone.checkMobilePhoneFocus()}),$("#mobilePhone").blur(function(){checkReg.mobilePhone.checkMobilePhone()}),$("#userName").bind("focus",function(){checkReg.userName.checkFocus()}),$("#userName").on("keyup",function(){checkReg.userName.checkKeypress()}),$("#userName").blur(function(){checkReg.userName.checkUserName()}),$("#email").bind("focus",function(){checkReg.email.checkEmailFocus()}),$("#email").blur(function(){checkReg.email.checkEmail()}),$("#name").bind("focus",function(){checkReg.name.checkNameFocus()}),$("#name").blur(function(){checkReg.name.checkName()}),$("#name").on("keyup",function(){checkReg.name.checkKeypress()}),$("#birthday").on("focus",function(){checkReg.birthday.checkBirthdayFocus()}),$("#birthday").on("blur",function(){checkReg.birthday.checkBirthday()}),$("#address4").on("focus",function(){checkReg.address.checkAddressFocus()}),$("#address4").on("keyup",function(){checkReg.address.checkKeypress()}),$("#address4").on("blur",function(){checkReg.address.checkAddress()}),$("form").submit(function(e){submitBtnAvailability("disable"),setTimeout(check_register(e),50)})});