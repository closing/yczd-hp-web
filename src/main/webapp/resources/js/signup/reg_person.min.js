function GetCharLength(a){var c,b=0;for(c=0;c<a.length;c++)b+=a.charCodeAt(c)>255?2:1;return b}function check_register(a){var b=$.trim($("#mobilePhone").val()),c=$.trim($("#userName").val()),d=$.trim($("#name").val());return $.trim($("#address4").val()),""==c||""==b||""==d?(""==b&&(checkReg.tool.switchInputStyle("error","mobilePhone","tipImgMobile","tipInfoMobilePhone"),$("#tipInfoMobilePhone").html(checkReg.lang_zh["3202"])),""==c&&(checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName"),$("#tipInfoUserName").html(checkReg.lang_zh["3102"])),""==d&&(checkReg.tool.switchInputStyle("error","name","tipImgName","tipInfoName"),$("#tipInfoName").html(checkReg.lang_zh["3132"])),submitBtnAvailability("enable"),a.preventDefault(),!1):mobilePhoneIsOk&&userNameIsOk&&emailIsOk&&nameIsOk&&birthdayIsOk&&address4IsOk?!0:(a.preventDefault(),submitBtnAvailability("enable"),!1)}function verifyRollback(){checkReg.mobilePhone.checkMobilePhone(),checkReg.userName.checkUserName(),checkReg.email.checkEmail(),checkReg.name.checkName(),checkReg.birthday.checkBirthday(),checkReg.address.checkAddress()}function submitBtnAvailability(a){"disable"==a?($("#saveButtonUnclick").show(),$("#saveButton").hide()):($("#saveButtonUnclick").hide(),$("#saveButton").show())}var mobilePhoneIsOk=!1,userNameIsOk=!1,emailIsOk=!1,nameIsOk=!1,birthdayIsOk=!1,address4IsOk=!1,checkReg={emailReg:/^(([a-zA-Z0-9]+\w*((\.\w+)|(-\w+))*[\.-]?[a-zA-Z0-9]+)|([a-zA-Z0-9]))\@[a-zA-Z0-9]+((\.|-)[a-zA-Z0-9]+)*\.[a-zA-Z0-9]+$/,mobilePhoneReg:/^1[3,4,5,6,7,8,9][0-9]{9}$/,numberReg:/^[0-9]*$/,nameReg:/^(\w|[\u4E00-\u9FA5]|\s)*$/,upperCaseReg:/[A-Z]/g,userNameReg:/^(\w|[\u4E00-\u9FA5])*$/,lang_zh:{3101:"4-20个字符，可由小写字母、中文、数字组成",3102:"用户名不能为空",3103:"该用户名已被使用，请更换其它用户名",3104:"最少4个字符，请输入您的用户名",3105:"最多只能为20个字符",3106:"用户名不能全由数字组成！",3107:"用户名不能有大写字母！",3108:"用户名只能是数字，小写字母和汉字",3110:"请填写真实姓名",3111:"请填写出生年月日",3112:"出生日期不正确，请重新输入",3132:"姓名不能为空",3141:"请选择并填写地址",3144:"地址最长只能为50个汉字（100个字符）",3151:"请输入邮箱",3153:"邮箱格式不正确，请重新输入",3154:"该邮箱已被注册，请更换其它邮箱",3193:"姓名只能为2-30个字符，不允许特殊符号",3201:"请输入手机号码",3202:"手机号不能为空",3203:"手机号格式不正确，请重新输入",3204:"此手机号已注册，请更换其它手机号",3241:"注册失败，请稍后重试。"},mobilePhone:{checkMobilePhoneFocus:function(){checkReg.tool.switchInputStyle("normal","mobilePhone","tipImgMobilePhone","tipInfoMobilePhone"),$("#tipInfoMobilePhone").html(checkReg.lang_zh["3201"])},checkMobilePhone:function(){var a,b;return checkReg.tool.switchInputStyle("normal","mobilePhone","tipImgMobile","tipInfoMobilePhone"),mobilePhoneIsOk=!1,a=!1,b=$.trim($("#mobilePhone").val()),""==b?!1:checkReg.mobilePhoneReg.test(b)?($.ajax({type:"POST",url:$("#contextPath").val()+"/commonapi/checkUser",dataType:"json",data:{key:b},async:!1,success:function(b){return 0==b?(checkReg.tool.switchInputStyle("error","mobilePhone","tipImgMobile","tipInfoMobilePhone"),$("#tipInfoMobilePhone").html(checkReg.lang_zh["3204"]),a=!0,!1):void 0}}),1==a?!1:(checkReg.tool.switchInputStyle("ok","mobilePhone","tipImgMobile","tipInfoMobilePhone"),mobilePhoneIsOk=!0,!0)):(checkReg.tool.switchInputStyle("error","mobilePhone","tipImgMobile","tipInfoMobilePhone"),$("#tipInfoMobilePhone").html(checkReg.lang_zh["3203"]),!1)}},userName:{checkFocus:function(){checkReg.tool.switchInputStyle("normal","userName","tipImgUserName","tipUserName"),$("#tipInfoUserName").html(checkReg.lang_zh["3101"])},checkKeypress:function(){var b,a=$.trim($("#userName").val());return""==a?!1:(b=checkReg.tool.VerifyCharLength(a,20),b&&"flag"in b&&b.flag===!1?(checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName"),$("#tipInfoUserName").text(checkReg.lang_zh["3105"]),$("#userName").val(a.substr(0,b.charLen)),!1):(checkReg.tool.switchInputStyle("normal","userName","tipImgUserName","tipInfoUserName"),void 0))},checkUserName:function(){var a,b,c;return userNameIsOk=!1,a=!1,checkReg.tool.switchInputStyle("normal","userName","tipImgUserName","tipInfoUserName"),b=$.trim($("#userName").val()),""==b?!1:(c=checkReg.userName.VerifyFormatUserName(b),c&&"flag"in c&&c.flag===!1?(checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName"),$("#tipInfoUserName").text(c.errorInfo),!1):($.ajax({type:"POST",url:$("#contextPath").val()+"/commonapi/checkUser",dataType:"json",data:{key:b},async:!1,success:function(c){return 0==c?(checkReg.tool.switchInputStyle("error","userName","tipImgUserName","tipInfoUserName"),$("#tipInfoUserName").html(checkReg.lang_zh["3103"].replace("{#userName#}",b)),a=!0,!1):void 0},error:function(){return!1}}),1==a?!1:(checkReg.tool.switchInputStyle("ok","userName","tipImgUserName","tipInfoUserName"),userNameIsOk=!0,!0)))},VerifyFormatUserName:function(a){var b="",c=!1,d={flag:c,errorInfo:""};return a&&""!=a&&(GetCharLength(a)<4?(b=checkReg.lang_zh["3104"],c=!1):GetCharLength(a)>20?(b=checkReg.lang_zh["3105"],c=!1):checkReg.numberReg.test(a)?(b=checkReg.lang_zh["3106"],c=!1):checkReg.upperCaseReg.test(a)?(b=checkReg.lang_zh["3107"],c=!1):a.match(checkReg.userNameReg)?c=!0:(b=checkReg.lang_zh["3108"],c=!1),d={flag:c,errorInfo:b}),d}},email:{checkEmailFocus:function(){checkReg.tool.switchInputStyle("normal","email","tipImgEmail","tipInfoEmail"),$("#tipInfoEmail").html(checkReg.lang_zh["3151"])},checkEmail:function(){var a,b;return emailIsOk=!1,a=!1,checkReg.tool.switchInputStyle("normal","email","tipImgEmail","tipInfoEmail"),b=$.trim($("#email").val()),""==b?(emailIsOk=!0,!0):b.length>40||!checkReg.emailReg.test(b)?(checkReg.tool.switchInputStyle("error","email","tipImgEmail","tipInfoEmail"),$("#tipInfoEmail").html(checkReg.lang_zh["3153"]),!1):/[ ]/.test(b)?(checkReg.tool.switchInputStyle("error","email","tipImgEmail","tipInfoEmail"),$("#tipInfoEmail").html(checkReg.lang_zh["3153"]),!1):($.ajax({type:"POST",url:$("#contextPath").val()+"/commonapi/checkUser",dataType:"json",data:{key:b},async:!1,success:function(b){return 0==b?(checkReg.tool.switchInputStyle("error","email","tipImgEmail","tipInfoEmail"),$("#tipInfoEmail").html(checkReg.lang_zh["3154"]),a=!0,void 0):void 0}}),1==a?!1:(checkReg.tool.switchInputStyle("ok","email","tipImgEmail","tipInfoEmail"),emailIsOk=!0,!0))}},name:{checkNameFocus:function(){checkReg.tool.switchInputStyle("normal","name","tipImgInfoName","tipInfoName"),$("#tipInfoName").html(checkReg.lang_zh["3110"])},checkKeypress:function(){var b,a=$.trim($("#name").val());return""==a?!0:(b=checkReg.tool.VerifyCharLength(a,30),b&&"flag"in b&&b.flag===!1?(checkReg.tool.switchInputStyle("error","name","tipImgInfoName","tipInfoName"),$("#tipInfoName").text(checkReg.lang_zh["3193"]),$("#name").val(a.substr(0,b.charLen)),!1):(checkReg.tool.switchInputStyle("normal","name","tipImgInfoName","tipInfoName"),!0))},checkName:function(){var a,b;return nameIsOk=!1,checkReg.tool.switchInputStyle("normal","name","tipImgInfoName","tipInfoName"),a=$.trim($("#name").val()),""==a?!1:(b=GetCharLength(a),2>b||b>30?(checkReg.tool.switchInputStyle("error","name","tipImgInfoName","tipInfoName"),$("#tipInfoName").html(checkReg.lang_zh["3193"]),!1):checkReg.nameReg.test(a)?(checkReg.tool.switchInputStyle("ok","name","tipImgInfoName","tipInfoName"),nameIsOk=!0,!0):(checkReg.tool.switchInputStyle("error","name","tipImgInfoName","tipInfoName"),$("#tipInfoName").html(checkReg.lang_zh["3193"]),!1))}},birthday:{checkBirthdayFocus:function(){checkReg.tool.switchInputStyle("normal","birthday","tipImgInfoBirthday","tipInfoBirthday"),$("#tipInfoBirthday").html(checkReg.lang_zh["3111"]);var a=$.trim($("#birthday").val());(null==a||""==a)&&$("#birthday").attr("value","1988-01-01")},checkBirthday:function(){var a,b,c;return birthdayIsOk=!1,checkReg.tool.switchInputStyle("normal","birthday","tipImgInfoBirthday","tipInfoBirthday"),a=$.trim($("#birthday").val()),""==a?(birthdayIsOk=!0,!0):0==(new Date(a).getDate()==a.substring(a.length-2))?(checkReg.tool.switchInputStyle("error","birthday","tipImgInfoBirthday","tipInfoBirthday"),$("#tipInfoBirthday").html(checkReg.lang_zh["3112"]),!1):(b=new Date,c=new Date(a),b.getFullYear()<=c.getFullYear()?(checkReg.tool.switchInputStyle("error","birthday","tipImgInfoBirthday","tipInfoBirthday"),$("#tipInfoBirthday").html(checkReg.lang_zh["3112"]),!1):(checkReg.tool.switchInputStyle("ok","birthday","tipImgInfoBirthday","tipInfoBirthday"),birthdayIsOk=!0,!0))}},address:{checkAddressFocus:function(){checkReg.tool.switchInputStyle("normal","address4","tipImgAddress4","tipInfoAddress4"),$("#tipInfoAddress4").html(checkReg.lang_zh["3141"])},checkKeypress:function(){var b,a=$.trim($("#address4").val());return""==a?!0:(b=checkReg.tool.VerifyCharLength(a,100),b&&"flag"in b&&b.flag===!1?(checkReg.tool.switchInputStyle("error","address4","tipImgAddress4","tipInfoAddress4"),$("#tipInfoAddress4").text(checkReg.lang_zh["3144"]),$("#address4").val(a.substr(0,b.charLen)),!1):(checkReg.tool.switchInputStyle("normal","address4","tipImgAddress4","tipInfoAddress4"),void 0))},checkAddress:function(){var b,c;return address4IsOk=!1,checkReg.tool.switchInputStyle("normal","address4","tipImgAddress4","tipInfoAddress4"),$("#tipInfoAddr"),b=$("#address4").val(),""==b?(address4IsOk=!0,!0):(c=GetCharLength(b),c>100?(checkReg.tool.switchInputStyle("error","address4","tipImgAddress4","tipInfoAddress4"),$("#tipInfoAddress4").html(checkReg.lang_zh["3144"]),!1):checkReg.nameReg.test(b)?(address4IsOk=!0,checkReg.tool.switchInputStyle("ok","address4","tipImgAddress4","tipInfoAddress4"),!0):(checkReg.tool.switchInputStyle("error","address4","tipImgAddress4","tipInfoAddress4"),$("#tipInfoAddress4").html(checkReg.lang_zh["3144"]),!1))}},tool:{switchInputStyle:function(a,b,c,d){"normal"==a?($("#"+b).removeClass("was-validated is-invalid is-valid"),$("#"+d).removeClass("invalid-feedback").addClass("valid-feedback").html("").css({display:"block"})):"ok"==a?($("#"+b).addClass("was-validated is-valid").removeClass("is-invalid"),$("#"+d).removeClass("invalid-feedback").addClass("valid-feedback").css({display:"block"})):"error"==a&&($("#"+b).addClass("was-validated is-invalid").removeClass("is-valid"),$("#"+d).addClass("invalid-feedback").addClass("valid-feedback").css({display:"block"}))},isFunc:function(a){return"function"==typeof a},VerifyCharLength:function(a,b){var f,g,h,c=b,d=!0,e={flag:d,charLen:c};if(a&&""!=a){if(GetCharLength(a)>b)for(f=a.length,d=!1,g=0,h=0;f>h;h++){if(g+=GetCharLength(a[h]),g==b){c=h+1;break}if(g>b){c=h;break}}e={flag:d,charLen:c}}return e}}};$(function(){verifyRollback(),$("#mobilePhone").bind("focus",function(){checkReg.mobilePhone.checkMobilePhoneFocus()}),$("#mobilePhone").blur(function(){checkReg.mobilePhone.checkMobilePhone()}),$("#userName").bind("focus",function(){checkReg.userName.checkFocus()}),$("#userName").on("keyup",function(){checkReg.userName.checkKeypress()}),$("#userName").blur(function(){checkReg.userName.checkUserName()}),$("#email").bind("focus",function(){checkReg.email.checkEmailFocus()}),$("#email").blur(function(){checkReg.email.checkEmail()}),$("#name").bind("focus",function(){checkReg.name.checkNameFocus()}),$("#name").blur(function(){checkReg.name.checkName()}),$("#name").on("keyup",function(){checkReg.name.checkKeypress()}),$("#birthday").on("focus",function(){checkReg.birthday.checkBirthdayFocus()}),$("#birthday").on("blur",function(){checkReg.birthday.checkBirthday()}),$("#address4").on("focus",function(){checkReg.address.checkAddressFocus()}),$("#address4").on("keyup",function(){checkReg.address.checkKeypress()}),$("#address4").on("blur",function(){checkReg.address.checkAddress()}),$("form").submit(function(a){submitBtnAvailability("disable"),setTimeout(check_register(a),50)})});